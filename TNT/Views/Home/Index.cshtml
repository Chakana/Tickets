@model IEnumerable<TNT.Models.Eventos>
@{
    ViewBag.Title = "Login";
    Layout = "";
}
@helper carousel(List<TNT.Models.Eventos> events, string carouselName)
{
    <div id="@carouselName" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            @{
                var i = 0;
                var index = 0;
                foreach (var item in events)
                {
                    index = i;
                    var itemClass = i++ == 0 ? "active" : " ";
                    <li data-target="#@carouselName" data-slide-to="@index" class="@itemClass">
                    </li>
                }
            }
        </ol>
        <!-- Images-->
        <div class="carousel-inner" role="listbox">
            @{
                i = 0;
                foreach (var item in events)
                {
                    var itemClass = i++ == 0 ? "item active" : "item";
                    <div class="@itemClass" id="item-@item.id">
                        <a href="@Url.Action("ComprarTicketsUsuario", "Ticket", new {id=@item.id })"><img src="@item.img_url" onerror="this.src='/Images/sponsor-bg.jpg'" style="height:300px" /></a>
                    </div>
                }
            }
        </div>

        <!-- Left Right Arrows -->
        <a class="left carousel-control" href="#@carouselName" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#@carouselName" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
}

@helper colage(List<TNT.Models.Eventos> events, string carouselName, string carouselNameTarget)
{
    var i = events.Count;
    <div id="@carouselName" class="carousel slide">

        <!-- Carousel items -->
        <div class="carousel-inner">
            @if (i > 6)
            {
                for (var c = 0; c < i / 6 + 1; c++)
                {
                    var itemClass = c == 0 ? "item active" : "item";
                    <div class="@itemClass">
                        <div class="row">
                            @for (var d = c * 6; d < (c + 1) * 6 && d < i; d++)
                            {
                                var el = events[d];
                                <a href="#item-@el.id" class="" data-target="#@carouselNameTarget" data-slide-to="@d"><img class="col-xs-2" src="@el.img_url" onerror="this.src='/Images/sponsor-bg.jpg'" alt="Image"></a>
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="item active">
                    <div class="row">
                        @for (var d = 0; d < i; d++)
                        {
                            var el = events[d];
                            <a href="#item-@el.id" class="" data-target="#@carouselNameTarget" data-slide-to="@d"><img class="col-xs-2" src="@el.img_url" onerror="this.src='/Images/sponsor-bg.jpg'" alt="Image"></a>
                        }
                    </div>
                </div>
            }

        </div>
        @if (i > 6)
        {
            <a class="left carousel-control" href="#@carouselName" data-slide="prev" style="width:5%;">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true" style="font-size: 20px;"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#@carouselName" data-slide="next" style="width:5%;">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true" style="font-size: 20px;"></span>
                <span class="sr-only">Previous</span>
            </a>
        }
    </div>
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>TNT</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet">
    <link href="~/Content/font-awesome.min.css" rel="stylesheet">
    <link href="~/Content/main.css" rel="stylesheet">
    <link href="~/Content/animate.css" rel="stylesheet">
    <link href="~/Content/responsive.css" rel="stylesheet">

    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="images/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="images/ico/apple-touch-icon-57-precomposed.png">
    <style>
        #overlay {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            right: 0;
            background: #000;
            opacity: 0.8;
            filter: alpha(opacity=80);
            z-index: 9999;
        }

        #loading {
            width: 100px;
            height: 25px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -28px 0 0 -25px;
        }

        html, body, #home, #main-slider, #main-slider .carousel-inner, #main-slider .carousel-inner .item {
            max-height: 100%;
            height: 100%;
        }

        .modal-content {
            background-color: #222222;
        }

        .close {
            color: #fff;
            opacity: 1;
        }

            .close:hover, .close:focus {
                color: #fff;
            }
    </style>
</head><!--/head-->

<body>
    <style>
        .iconos-home {
            transition: all .2s ease-in-out;
            opacity: 0;
            left: 100%;
            position: relative;
        }

            .iconos-home:hover {
                transform: scale(1.3);
            }

            .iconos-home a span {
                font-weight: bold;
                font-size: xx-large;
            }
    </style>
    <div id="overlay" style="display:none;">
        <img id="loading" src="~/Images/ajax-loader.gif" />
    </div>
    @{
        bool isWelcome = TempData["IsWelcome"] != null && bool.Parse(TempData["IsWelcome"].ToString());
    }
    @if (isWelcome)
    {
        <div id="modal-welcome" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <p>Bienvenido @ViewBag.nombreUsuario</p>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
    }
    <header id="header" role="banner">
        <div class="main-nav">
            <div class="container">

                <div class="row">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="#">
                            <img class="img-responsive" src="~/images/logo_tnt.png" alt="logo" style="width: 150px;">
                        </a>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">

                            @if (Request.IsAuthenticated)
                            {
                                if (User.IsInRole("usuario"))
                                {
                                    <li>@Html.ActionLink(Session["full_name"].ToString(), "edit", "Personas", routeValues: new { id = Session["persona_id"] }, htmlAttributes: new { @class = "username", title = "Administrar" })</li>
                                }

                            }
                            else
                            {
                                <li><a class="no-scroll" href="@Url.Action("login", "account")">LOGIN</a></li>
                                @*<li><a data-toggle="modal" data-target="#myLogin" class="no-scroll" href="#">LOGIN</a></li>*@
                            }
                            <li class="scroll"><a href="@Url.Action("VerEventosUsuario", "Event")">Búsqueda avanzada</a></li>
                            <li class="scroll"><a href="@Url.Action("Index", "PuntosPagos")">Puntos de pago</a></li>
                            <li class="scroll"><a href="@Url.Content("~/Content/terminos.pdf")" target="_blank">Terminos y condiciones</a></li>
                            @if (Request.IsAuthenticated)
                            {
                                <li class="scroll">
                                    @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm" }))
                                    {
                                        @Html.AntiForgeryToken()
                                        <a style="float:right" class="scroll" href="javascript:document.getElementById('logoutForm').submit()">Cerrar sesión</a>
                                    }

                                </li>
                            }
                        </ul>
                    </div>
                </div>
                <ul id="menu-interactive" class="col-md-3 list-unstyled" style="margin-left: 30px;">
                    <li class="iconos-home"><a data-toggle="modal" data-target="#modalConciertos" class="" href="#"><img class="" src="~/images/icon_conciertos.png" alt="logo" style="width: 70px;"><span style="color:#69D2D3;display:inline-block;">Conciertos</span></a></li>
                    <li class="iconos-home"><a data-toggle="modal" data-target="#modalDeportes" class="" href="#"><img class="" src="~/images/icon_deporte.png" alt="logo" style="width: 70px;"><span style="color:#02016C;display:inline-block;">Deportes</span></a></li>
                    <li class="iconos-home"><a data-toggle="modal" data-target="#modalViajesTurismo" class="" href="#"><img class="" src="~/images/icon_viajes_turismo.png" alt="logo" style="width: 70px;"><span style="color:#FC8C1C;display:inline-block;">Viajes</span></a></li>
                    <li class="iconos-home"><a data-toggle="modal" data-target="#modalCultura" class="" href="#"><img class="" src="~/images/icon_cultura.png" alt="logo" style="width: 70px;"><span style="color:#7CE34F;display:inline-block;">Cultura</span></a></li>
                    <li class="iconos-home"><a data-toggle="modal" data-target="#modalVarios" class="" href="#"><img class="" src="~/images/icon_articulos.png" alt="logo" style="width: 70px;"><span style="color:#FEE400;display:inline-block;">Varios</span></a></li>
                </ul>
            </div>
        </div>
    </header>
    <!--/#header-->

    <section id="home">
        <div id="main-slider" class="carousel slide" data-ride="carousel" data-pause="false">
            <div class="carousel-inner">
                <div class="item active">
                    <img class="img" src="~/images/slider/concert.jpg" style="height:100%;" alt="slider">

                </div>
                <div class="item">
                    <img class="img" src="~/images/slider/sport.jpg" style="height:100%;" alt="slider">

                </div>
                <div class="item">
                    <img class="img" src="~/images/slider/gift.jpg" style="height:100%;" alt="slider">

                </div>
                <div class="item">
                    <img class="img" src="~/images/slider/voyage.jpg" style="height:100%;" alt="slider">

                </div>
                <div class="item">
                    <img class="img" src="~/images/slider/trip.jpg" style="height:100%;" alt="slider">

                </div>
            </div>
        </div>
    </section>
    <!--/#home-->
    <div class="modal fade bs-example-modal-sm" id="myLogin" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">


                <div class="col-md-12">
                    <div class="form-login">
                        <input type="email" id="userName" class="form-control input-sm chat-input" placeholder="email" />
                        <br />
                        <input type="password" id="userPassword" class="form-control input-sm chat-input" />
                        <br />
                        <div class="wrapper">
                            <span class="group-btn">
                                <button id="btn_login" class="btn btn-danger btn-md">login<i class="fa fa-sign-in"></i></button>
                            </span>
                        </div>
                    </div>

                </div>

            </div>


        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="modalConciertos" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">CONCIERTOS</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @carousel(ViewBag.eventosConciertos, "myCarouselConciertos")
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-12">
                            @colage(ViewBag.eventosConciertos, "myColageConciertos", "myCarouselConciertos")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="modalVarios" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">VARIOS</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @carousel(ViewBag.eventosVarios, "myCarouselVarios")
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-12">
                            @colage(ViewBag.eventosVarios, "myColageVarios", "myCarouselVarios")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="modalDeportes" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">DEPORTES</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @carousel(ViewBag.eventosDeportes, "myCarouselDeportes")
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-12">
                            @colage(ViewBag.eventosDeportes, "myColageDeportes", "myCarouselDeportes")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="modalViajesTurismo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">TURISMO</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @carousel(ViewBag.eventosViajesTurismo, "myCarouselTurismo")
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-12">
                            @colage(ViewBag.eventosViajesTurismo, "myColageTurismo", "myCarouselTurismo")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="modalCultura" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">CULTURA</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @carousel(ViewBag.eventosCultura, "myCarouselCultura")
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-12">
                            @colage(ViewBag.eventosCultura, "myColageCultura", "myCarouselCultura")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--/#footer-->

    <script type="text/javascript" src="~/Scripts/jquery.js"></script>
    <script type="text/javascript" src="~/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="~/Scripts/gmaps.js"></script>
    <script type="text/javascript" src="~/Scripts/smoothscroll.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery.parallax.js"></script>
    <script type="text/javascript" src="~/Scripts/coundown-timer.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery.scrollTo.js"></script>
    @*<script type="text/javascript" src="~/Scripts/jquery.nav.js"></script>*@
    <script type="text/javascript" src="~/Scripts/main.js"></script>
    <script>
        $('[id^=carousel-selector-]').click(function () {
            var id_selector = $(this).attr("id");
            var id = id_selector.substr(id_selector.length - 1);
            id = parseInt(id);
            $('#myCarouselConciertos').carousel(id);
            $('[id^=carousel-selector-]').removeClass('selected');
            $(this).addClass('selected');

        });

        // when the carousel slides, auto update
        $('#myCarouselConciertos').on('slid', function (e) {
            var id = $('.item.active').data('slide-number');
            id = parseInt(id);
            $('[id^=carousel-selector-]').removeClass('selected');
            $('[id=carousel-selector-' + id + ']').addClass('selected');
        });


        $(function () {
            $('.iconos-home').hover(function () {
                var $this = $(this);
                $this.find('span').show();
            }, function () {
                var $this = $(this);
                $this.find('span').hide();
            })

            $(document).ajaxSend(function () {
                $('#overlay').show();
            });

            $(document).ajaxComplete(function () {
                $('#overlay').hide();
            })

            window.onbeforeunload = function () {
                $('#overlay').show();
            }

            $('.link-collage').click(function (e) {
                e.preventDefault();
                var $this = $(this);
                $('.item').removeClass('active');
                $($this.attr('href')).addClass('active');
            });

            if ($('#modal-welcome').length > 0) {
                $('#modal-welcome').modal('show');
                setTimeout(function () {
                    $('#modal-welcome').modal('hide');
                }, 3000);
            }
            var i = 0;
            $('.iconos-home').each(function (e) {
                $(this)
                .delay(++i * 1000)
                .animate({ left: 0, opacity: 1 })
            }).promise().done(function () {
                //setInterval(parpa(), 1000);
                //setTimeout("$('.iconos-home').stop(true,true).css('opacity', 1);$('.iconos-home').find('span').hide('slow');", 5000);
                $('.iconos-home').find('span').hide('slow');
            });

            function parpa() {
                $('.iconos-home').fadeTo(100, 0.1).fadeTo(200, 1, parpa);
                //setTimeout("$('.iconos-home').stop(true,true).css('opacity', 1);$('.iconos-home').find('span').hide('slow');", 5000);
            }
        })
        //$('#btn_login').click(function () {
        //    var data = { email: $('#userName').val(),password:$('#userPassword').val()};
        //    $.ajax({
        //        url: '/Account/LoginJSON',
        //        type: "POST",
        //        data: JSON.stringify(data),
        //        dataType: "JSON",
        //        contentType: "application/json",
        //        success: function (response) {
        //            console.log(response);
        //            location.reload();
        //        },
        //        error: function () {

        //        }
        //    });
        //});
    </script>
    <script>


        function CargaMapa(index, lat, lng) {
            var map;
            map = new GMaps({
                el: $('.gmap').get(index - 1),
                lat: lat,
                lng: lng,
                scrollwheel: false,
                zoom: 16,
                zoomControl: false,
                panControl: false,
                streetViewControl: false,
                mapTypeControl: false,
                overviewMapControl: false,
                clickable: false
            });

            var image = 'images/map-icon.png';
            map.addMarker({
                lat: lat,
                lng: lng,
                icon: image,
                animation: google.maps.Animation.DROP,
                verticalAlign: 'bottom',
                horizontalAlign: 'center',
                backgroundColor: '#3e8bff',
            });


            var styles = [

            {
                "featureType": "road",
                "stylers": [
                { "color": "#b4b4b4" }
                ]
            }, {
                "featureType": "water",
                "stylers": [
                { "color": "#d8d8d8" }
                ]
            }, {
                "featureType": "landscape",
                "stylers": [
                { "color": "#f1f1f1" }
                ]
            }, {
                "elementType": "labels.text.fill",
                "stylers": [
                { "color": "#000000" }
                ]
            }, {
                "featureType": "poi",
                "stylers": [
                { "color": "#d9d9d9" }
                ]
            }, {
                "elementType": "labels.text",
                "stylers": [
                { "saturation": 1 },
                { "weight": 0.1 },
                { "color": "#000000" }
                ]
            }

            ];

            map.addStyle({
                styledMapName: "Styled Map",
                styles: styles,
                mapTypeId: "map_style"
            });

            map.setStyle("map_style");
        }
        function CargaContadoresEventos(index, eventDate) {
            console.log(eventDate);
            thisEl = $('#countdown').get(index - 1);
            eventDate = Date.parse(eventDate) / 1000;
            //console.log(eventDate);
            //console.log(settings['date']);
            currentDate = Math.floor($.now() / 1000);



            seconds = eventDate - currentDate;

            days = Math.floor(seconds / (60 * 60 * 24)); //calculate the number of days
            seconds -= days * 60 * 60 * 24; //update the seconds variable with no. of days removed

            hours = Math.floor(seconds / (60 * 60));
            seconds -= hours * 60 * 60; //update the seconds variable with no. of hours removed

            minutes = Math.floor(seconds / 60);
            seconds -= minutes * 60; //update the seconds variable with no. of minutes removed

            //conditional Ss
            if (days == 1) { thisEl.find(".timeRefDays").text("day"); } else { thisEl.find(".timeRefDays").text("days"); }
            if (hours == 1) { thisEl.find(".timeRefHours").text("hour"); } else { thisEl.find(".timeRefHours").text("hours"); }
            if (minutes == 1) { thisEl.find(".timeRefMinutes").text("minute"); } else { thisEl.find(".timeRefMinutes").text("minutes"); }
            if (seconds == 1) { thisEl.find(".timeRefSeconds").text("second"); } else { thisEl.find(".timeRefSeconds").text("seconds"); }

            //logic for the two_digits ON setting
            //if (settings['format'] == "on") {
            days = (String(days).length >= 2) ? days : "0" + days;
            hours = (String(hours).length >= 2) ? hours : "0" + hours;
            minutes = (String(minutes).length >= 2) ? minutes : "0" + minutes;
            seconds = (String(seconds).length >= 2) ? seconds : "0" + seconds;
            //}

            //update the countdown's html values.
            if (!isNaN(eventDate)) {
                thisEl.find(".days").text(days);
                thisEl.find(".hours").text(hours);
                thisEl.find(".minutes").text(minutes);
                //thisEl.find(".seconds").text(seconds);
            } else {
                console.log("error");
                clearInterval(interval);
            }
        }
    </script>
</body>
</html>